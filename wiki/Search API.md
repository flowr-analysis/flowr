_This document was generated from '[src/documentation/wiki-search.ts](https://github.com/flowr-analysis/flowr/tree/main//src/documentation/wiki-search.ts)' on 2025-12-02, 15:22:20 UTC presenting an overview of flowR's search API (v2.6.3, using R v4.5.0). Please do not edit this file/wiki page directly._

This page briefly summarizes flowR's search API which provides a set of functions to search for nodes in the [Dataflow Graph](https://github.com/flowr-analysis/flowr/wiki/Dataflow-Graph) and the 
[Normalized AST](https://github.com/flowr-analysis/flowr/wiki/Normalized-AST) of a given R code (the search will always consider both, with respect to your search query).
Please see the [Interface](https://github.com/flowr-analysis/flowr/wiki/Interface) wiki page for more information on how to access this API.
Within code, you can execute a search using the <a href="https://github.com/flowr-analysis/flowr/tree/main//src/project/flowr-analyzer.ts#L116"><code><span title="Run a search on the current analysis.">runSearch</span></code></a> function.

For an initial motivation, let's have a look at the following example:




```ts
Q.var("x")
```


<details style="color:gray"> <summary>Search Visualization</summary>


```mermaid
flowchart LR
0("<b>get</b>(filter: #123;#34;name#34;#58;#34;x#34;#125;)<br/>_generator_")
```


In the code:


```r
x <- x * x
```


<details style="color:gray"> <summary>JSON Representation</summary>


```json
{
  "generator": {
    "type": "generator",
    "name": "get",
    "args": {
      "filter": {
        "name": "x"
      }
    }
  },
  "search": []
}
```


</details>

</details>


 <details> <summary style="color:gray">Show Results</summary>

The query returns the following vetices (all references to `x` in the code):
<b>0 ('x')</b> at L1.1, <b>1 ('x')</b> at L1.6, <b>2 ('x')</b> at L1.10

The search required _10.1 ms_ (including parsing and normalization and the query) within the generation environment.

The returned results are highlighted thick and blue within the dataflow graph:





```mermaid
flowchart LR
    1(["`#91;RSymbol#93; x
      (1)
      *1.6*`"])
    2(["`#91;RSymbol#93; x
      (2)
      *1.10*`"])
    3[["`#91;RBinaryOp#93; #42;
      (3)
      *1.6-10*
    (1, 2)`"]]
    built-in:_["`Built-In:
#42;`"]
    style built-in:_ stroke:gray,fill:lightgray,stroke-width:2px,opacity:.8;
    0["`#91;RSymbol#93; x
      (0)
      *1.1*`"]
    4[["`#91;RBinaryOp#93; #60;#45;
      (4)
      *1.1-10*
    (0, 3)`"]]
    built-in:_-["`Built-In:
#60;#45;`"]
    style built-in:_- stroke:gray,fill:lightgray,stroke-width:2px,opacity:.8;
    3 -->|"reads, argument"| 1
    3 -->|"reads, argument"| 2
    3 -.->|"reads, calls"| built-in:_
    linkStyle 2 stroke:gray;
    0 -->|"defined-by"| 3
    0 -->|"defined-by"| 4
    4 -->|"argument"| 3
    4 -->|"returns, argument"| 0
    4 -.->|"reads, calls"| built-in:_-
    linkStyle 7 stroke:gray;
```

	
(The analysis required _3.4 ms_ (including parse and normalize, using the [r-shell](https://github.com/flowr-analysis/flowr/wiki/Engines) engine) within the generation environment.)




</details>

	

This returns all references to the variable `x` in the code.
However, the search API is not limited to simple variable references and can do much more.

For example, let's have every definition of `x` in the code but the first one:




```ts
Q.var("x").filter(VertexType.VariableDefinition).skip(1)
```


<details style="color:gray"> <summary>Search Visualization</summary>


```mermaid
flowchart LR
0("<b>get</b>(filter: #123;#34;name#34;#58;#34;x#34;#125;)<br/>_generator_") --> 1["<b>filter</b>(filter: #34;vdef#34;)<br/>_transformer_"] --> 2["<b>skip</b>(count: 1)<br/>_transformer_"]
```


In the code:


```r
x <- x * x
print(x)
x <- y <- 3
print(x)
x <- 2
```


<details style="color:gray"> <summary>JSON Representation</summary>


```json
{
  "generator": {
    "type": "generator",
    "name": "get",
    "args": {
      "filter": {
        "name": "x"
      }
    }
  },
  "search": [
    {
      "type": "transformer",
      "name": "filter",
      "args": {
        "filter": "vdef"
      }
    },
    {
      "type": "transformer",
      "name": "skip",
      "args": {
        "count": 1
      }
    }
  ]
}
```


</details>

</details>


 <details> <summary style="color:gray">Show Results</summary>

The query returns the following vetices (all references to `x` in the code):
<b>9 ('x')</b> at L3.1, <b>18 ('x')</b> at L5.1

The search required _8.0 ms_ (including parsing and normalization and the query) within the generation environment.

The returned results are highlighted thick and blue within the dataflow graph:





```mermaid
flowchart LR
    1(["`#91;RSymbol#93; x
      (1)
      *1.6*`"])
    2(["`#91;RSymbol#93; x
      (2)
      *1.10*`"])
    3[["`#91;RBinaryOp#93; #42;
      (3)
      *1.6-10*
    (1, 2)`"]]
    built-in:_["`Built-In:
#42;`"]
    style built-in:_ stroke:gray,fill:lightgray,stroke-width:2px,opacity:.8;
    0["`#91;RSymbol#93; x
      (0)
      *1.1*`"]
    4[["`#91;RBinaryOp#93; #60;#45;
      (4)
      *1.1-10*
    (0, 3)`"]]
    built-in:_-["`Built-In:
#60;#45;`"]
    style built-in:_- stroke:gray,fill:lightgray,stroke-width:2px,opacity:.8;
    6(["`#91;RSymbol#93; x
      (6)
      *2.7*`"])
    8[["`#91;RFunctionCall#93; print
      (8)
      *2.1-8*
    (6)`"]]
    built-in:print["`Built-In:
print`"]
    style built-in:print stroke:gray,fill:lightgray,stroke-width:2px,opacity:.8;
    11{{"`#91;RNumber#93; 3
      (11)
      *3.11*`"}}
    10["`#91;RSymbol#93; y
      (10)
      *3.6*`"]
    12[["`#91;RBinaryOp#93; #60;#45;
      (12)
      *3.6-11*
    (10, 11)`"]]
    9["`#91;RSymbol#93; x
      (9)
      *3.1*`"]
    13[["`#91;RBinaryOp#93; #60;#45;
      (13)
      *3.1-11*
    (9, 12)`"]]
    15(["`#91;RSymbol#93; x
      (15)
      *4.7*`"])
    17[["`#91;RFunctionCall#93; print
      (17)
      *4.1-8*
    (15)`"]]
    19{{"`#91;RNumber#93; 2
      (19)
      *5.6*`"}}
    18["`#91;RSymbol#93; x
      (18)
      *5.1*`"]
    20[["`#91;RBinaryOp#93; #60;#45;
      (20)
      *5.1-6*
    (18, 19)`"]]
    3 -->|"reads, argument"| 1
    3 -->|"reads, argument"| 2
    3 -.->|"reads, calls"| built-in:_
    linkStyle 2 stroke:gray;
    0 -->|"defined-by"| 3
    0 -->|"defined-by"| 4
    4 -->|"argument"| 3
    4 -->|"returns, argument"| 0
    4 -.->|"reads, calls"| built-in:_-
    linkStyle 7 stroke:gray;
    6 -->|"reads"| 0
    8 -->|"reads, returns, argument"| 6
    8 -.->|"reads, calls"| built-in:print
    linkStyle 10 stroke:gray;
    10 -->|"defined-by"| 11
    10 -->|"defined-by"| 12
    12 -->|"argument"| 11
    12 -->|"returns, argument"| 10
    12 -.->|"reads, calls"| built-in:_-
    linkStyle 15 stroke:gray;
    9 -->|"defined-by"| 12
    9 -->|"defined-by"| 13
    13 -->|"argument"| 12
    13 -->|"returns, argument"| 9
    13 -.->|"reads, calls"| built-in:_-
    linkStyle 20 stroke:gray;
    15 -->|"reads"| 9
    17 -->|"reads, returns, argument"| 15
    17 -.->|"reads, calls"| built-in:print
    linkStyle 23 stroke:gray;
    18 -->|"defined-by"| 19
    18 -->|"defined-by"| 20
    20 -->|"argument"| 19
    20 -->|"returns, argument"| 18
    20 -.->|"reads, calls"| built-in:_-
    linkStyle 28 stroke:gray;
```

	
(The analysis required _4.5 ms_ (including parse and normalize, using the [r-shell](https://github.com/flowr-analysis/flowr/wiki/Engines) engine) within the generation environment.)




</details>

	

In summary, every search has two parts. It is initialized with a _generator_ (such as `Q.var('x')`)
and can be further refined with _transformers_ or _modifiers_.
Such queries can be constructed starting from the <a href="https://github.com/flowr-analysis/flowr/tree/main//src/search/flowr-search-builder.ts#L114"><code><span title="This is the root object to use for creating searches. See the FlowrSearchGenerator for the available methods. After the query is generated, you can use what is provided by the FlowrSearchBuilder to further refine the search.">Q</span></code></a> object (backed by <a href="https://github.com/flowr-analysis/flowr/tree/main//src/search/flowr-search-builder.ts#L26"><code><span title="This object holds all the methods to generate search queries. For compatibility, please use the Q identifier object to access these methods.">FlowrSearchGenerator</span></code></a>) and
are fully serializable so you can use them when communicating with the [Query API](https://github.com/flowr-analysis/flowr/wiki/Query%20API).

We offer the following generators:

- <a href="https://github.com/flowr-analysis/flowr/tree/main//src/search/flowr-search-builder.ts#L53"><code><span title="Returns all elements (nodes/dataflow vertices) from the given data.">FlowrSearchGenerator::<b>all</b></span></code></a>\
Returns all elements (nodes/dataflow vertices) from the given data.
- <a href="https://github.com/flowr-analysis/flowr/tree/main//src/search/flowr-search-builder.ts#L73"><code><span title="Returns all elements that match the given criteria (e.g., criterion('2@x', '3@<-'), to retrieve the first use of x in the second line and the first <- assignment in the third line). This will throw an error, if any criteria cannot be resolved to an id.">FlowrSearchGenerator::<b>criterion</b></span></code></a>\
Returns all elements that match the given
<code>criteria</code>
(e.g., `criterion('2@x', '3@<-')`,
to retrieve the first use of `x` in the second line and the first `<-` assignment in the third line).
This will throw an error, if any criteria cannot be resolved to an id.
- <a href="https://github.com/flowr-analysis/flowr/tree/main//src/search/flowr-search-builder.ts#L32"><code><span title="Initialize a search query with the given elements. <b>This is not intended to serialize well</b> wrt. the nodes, see FlowrSearchGenerator.criterion for a serializable alternative (passing the ids with $id).">FlowrSearchGenerator::<b>from</b></span></code></a>\
Initialize a search query with the given elements.
<b>This is not intended to serialize well</b> wrt. the nodes,
see
<code>FlowrSearchGenerator.criterion</code>
for a serializable alternative (passing the ids with `$id`).
- <a href="https://github.com/flowr-analysis/flowr/tree/main//src/search/flowr-search-builder.ts#L40"><code><span title="Initializes a new search query based on the results of the given JSON query or queries. Internally, the SupportedQuery#flattenInvolvedNodes function is used to flatten the resulting nodes of the query. Please note that, due to the fact that not every query involves dataflow nodes, the search may not contain any elements at all for certain queries.">FlowrSearchGenerator::<b>fromQuery</b></span></code></a>\
Initializes a new search query based on the results of the given JSON query or queries.
Internally, the
<code>SupportedQuery#flattenInvolvedNodes</code>
function is used to flatten the resulting nodes of the query.
Please note that, due to the fact that not every query involves dataflow nodes, the search may not contain any elements at all for certain queries.
- <a href="https://github.com/flowr-analysis/flowr/tree/main//src/search/flowr-search-builder.ts#L61"><code><span title="Returns all elements that match the given filters . You may pass a negative line number to count from the back. Please note that this is currently only working for single files, it approximates over the nodes, and it is not to be used for 'production'.">FlowrSearchGenerator::<b>get</b></span></code></a>\
Returns all elements that match the given
<code>filters</code>
.
You may pass a negative line number to count from the back.
Please note that this is currently only working for single files, it approximates over the nodes, and it is not to be used for "production".
- <a href="https://github.com/flowr-analysis/flowr/tree/main//src/search/flowr-search-builder.ts#L103"><code><span title="Short form of get with only the id filter: get({id}).">FlowrSearchGenerator::<b>id</b></span></code></a>\
Short form of
<code>get</code>
with only the
<code>id</code>
filter:
`get({id})`.
- <a href="https://github.com/flowr-analysis/flowr/tree/main//src/search/flowr-search-builder.ts#L82"><code><span title="Short form of get with only the line and column filters: get({line, column}).">FlowrSearchGenerator::<b>loc</b></span></code></a>\
Short form of
<code>get</code>
with only the
<code>line</code>
and
<code>column</code>
filters:
`get({line, column})`.
- <a href="https://github.com/flowr-analysis/flowr/tree/main//src/search/flowr-search-builder.ts#L47"><code><span title="Initializes a new search query based on the results of the given tree-sitter syntax query. Please note that this search generator is incompatible with the RShell parser and only works when using flowR with the TreeSitterExecutor .">FlowrSearchGenerator::<b>syntax</b></span></code></a>\
Initializes a new search query based on the results of the given tree-sitter syntax query.
Please note that this search generator is incompatible with the
<code>RShell</code>
parser and only works when using flowR with the
<code>TreeSitterExecutor</code>
.
- <a href="https://github.com/flowr-analysis/flowr/tree/main//src/search/flowr-search-builder.ts#L96"><code><span title="Short form of get with only the name filter: get({name}).">FlowrSearchGenerator::<b>var</b></span></code></a>\
Short form of
<code>get</code>
with only the
<code>name</code>
filter:
`get({name})`.
- <a href="https://github.com/flowr-analysis/flowr/tree/main//src/search/flowr-search-builder.ts#L89"><code><span title="Short form of get with only the name and line filters: get({name, line}).">FlowrSearchGenerator::<b>varInLine</b></span></code></a>\
Short form of
<code>get</code>
with only the
<code>name</code>
and
<code>line</code>
filters:
`get({name, line})`.

Likewise, we have a palette of _transformers_ and _modifiers_:

- <a href="https://github.com/flowr-analysis/flowr/tree/main//src/search/flowr-search-builder.ts#L270"><code><span title="Construct the final search (this may happen automatically with most search handlers).">FlowrSearchBuilder::<b>build</b></span></code></a>\
Construct the final search (this may happen automatically with most search handlers).
- <a href="https://github.com/flowr-analysis/flowr/tree/main//src/search/flowr-search-builder.ts#L159"><code><span title="only returns the elements that match the given filter.">FlowrSearchBuilder::<b>filter</b></span></code></a>\
only returns the elements that match the given filter.
- <a href="https://github.com/flowr-analysis/flowr/tree/main//src/search/flowr-search-builder.ts#L167"><code><span title="first either returns the first element of the search or nothing, if no elements are present.">FlowrSearchBuilder::<b>first</b></span></code></a>\
first either returns the first element of the search or nothing, if no elements are present.
- <a href="https://github.com/flowr-analysis/flowr/tree/main//src/search/flowr-search-builder.ts#L182"><code><span title="index returns the element at the given index if it exists">FlowrSearchBuilder::<b>index</b></span></code></a>\
index returns the element at the given index if it exists
- <a href="https://github.com/flowr-analysis/flowr/tree/main//src/search/flowr-search-builder.ts#L175"><code><span title="last either returns the last element of the search or nothing, if no elements are present.">FlowrSearchBuilder::<b>last</b></span></code></a>\
last either returns the last element of the search or nothing, if no elements are present.
- <a href="https://github.com/flowr-analysis/flowr/tree/main//src/search/flowr-search-builder.ts#L236"><code><span title="Maps the elements of the search to new values using the given mapper function.">FlowrSearchBuilder::<b>map</b></span></code></a>\
Maps the elements of the search to new values using the given mapper function.
- <a href="https://github.com/flowr-analysis/flowr/tree/main//src/search/flowr-search-builder.ts#L251"><code><span title="merge combines the search results with those of another search.">FlowrSearchBuilder::<b>merge</b></span></code></a>\
merge combines the search results with those of another search.
- <a href="https://github.com/flowr-analysis/flowr/tree/main//src/search/flowr-search-builder.ts#L217"><code><span title="select returns only the elements at the given indices.">FlowrSearchBuilder::<b>select</b></span></code></a>\
select returns only the elements at the given indices.
- <a href="https://github.com/flowr-analysis/flowr/tree/main//src/search/flowr-search-builder.ts#L208"><code><span title="skip returns all elements of the search except the first count ones.">FlowrSearchBuilder::<b>skip</b></span></code></a>\
skip returns all elements of the search except the first `count` ones.
- <a href="https://github.com/flowr-analysis/flowr/tree/main//src/search/flowr-search-builder.ts#L191"><code><span title="tail returns all elements of the search except the first one.">FlowrSearchBuilder::<b>tail</b></span></code></a>\
tail returns all elements of the search except the first one.
- <a href="https://github.com/flowr-analysis/flowr/tree/main//src/search/flowr-search-builder.ts#L199"><code><span title="take returns the first count elements of the search.">FlowrSearchBuilder::<b>take</b></span></code></a>\
take returns the first `count` elements of the search.
- <a href="https://github.com/flowr-analysis/flowr/tree/main//src/search/flowr-search-builder.ts#L244"><code><span title="A convenience function that combines with and the Mapper.Enrichment mapper to immediately add an enrichment and then map to its value(s).">FlowrSearchBuilder::<b>to</b></span></code></a>\
A convenience function that combines
<code>with</code>
and the
<code>Mapper.Enrichment</code>
mapper to immediately add an enrichment and then map to its value(s).
- <a href="https://github.com/flowr-analysis/flowr/tree/main//src/search/flowr-search-builder.ts#L261"><code><span title="Removes duplicate elements based on the ids of the elements.">FlowrSearchBuilder::<b>unique</b></span></code></a>\
Removes duplicate elements based on the ids of the elements.
- <a href="https://github.com/flowr-analysis/flowr/tree/main//src/search/flowr-search-builder.ts#L228"><code><span title="Adds the given enrichment to each element of the search. Added enrichments can later be retrieved using the enrichmentContent function.">FlowrSearchBuilder::<b>with</b></span></code></a>\
Adds the given enrichment to each element of the search.
Added enrichments can later be retrieved using the
<code>enrichmentContent</code>
function.

Every search (and consequently the search pipeline) works with an array of <a href="https://github.com/flowr-analysis/flowr/tree/main//src/search/flowr-search.ts#L18"><code><span title="Yes, for now we do technically not need a wrapper around the RNode, but this allows us to attach caches etc. just for the respective search.">FlowrSearchElement</span></code></a> (neatly wrapped in <a href="https://github.com/flowr-analysis/flowr/tree/main//src/search/flowr-search.ts#L71"><code><span title="Intentionally, we abstract away from an array to avoid the use of conventional typescript operations">FlowrSearchElements</span></code></a>).
Hence, even operations such as `.first` or `.last` return an array of elements (albeit with a single or no element).
The search API does its best to stay typesafe wrt. to the return type and the transformers in use. 
In addition, it offers optimizer passes to optimize the search pipeline before execution.
They are executed with `.build` which may happen automatically, whenever you want to run a search using <a href="https://github.com/flowr-analysis/flowr/tree/main//src/project/flowr-analyzer.ts#L116"><code><span title="Run a search on the current analysis.">runSearch</span></code></a>.
